var o = getApp(), e = require("../../nitro.js"); Page({ data: { isIpx: o.globalData.isIpx, aggreed: !1 }, checkboxChange: function (o) { console.info("checkboxChange", o), this.setData({ aggreed: !this.data.aggreed }) }, onLoad: function (e) { console.log("app.globalData", o.globalData); var n = o.globalData.cart, i = []; n.items.forEach(function (o) { i.push({ type: o.type, item_id: o.id, quantity: 1 }) }); var t = { store_id: o.globalData.cart.storeId, inventory_id: n.inventory.id, inventory_version: n.inventory.version, shipping_address: { address: n.info.shipping_address.address || "address", recipient: n.info.shipping_address.recipient || "recipient", mobile: n.info.shipping_address.mobile || "mobile" }, children: n.info.children, order_items: i, coupon_id: "", mobile: n.info.contact.mobile, name: n.info.contact.name, extra: n.info.extra }; this.setData({ cart: o.globalData.cart, order: t }) }, onReady: function () { }, onShow: function () { }, onHide: function () { }, onUnload: function () { }, onPullDownRefresh: function () { }, onReachBottom: function () { }, onShareAppMessage: function () { }, onSubmit: function () { wx.showLoading({ title: "创建订单…", mask: !0 }), this.onCreateOrder() }, onCreateOrder: function () { return o.postRequest(o.globalData.BASE_URL + "/orders", this.data.order).then(function (o) { console.info("order", o), e.payOrder(o._id) }, function (o) { console.error("err", o), wx.showToast({ title: o.message, icon: "none", duration: 2e3, success: function () { } }) }) } }); 